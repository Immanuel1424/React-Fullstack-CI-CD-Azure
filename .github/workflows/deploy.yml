      - name: Deploy from public to private instance
        run: |
          ssh -A ubuntu@${{ secrets.PUBLIC_INSTANCE_IP }} 'bash -s' <<'EOF'
          echo "ðŸš€ Connecting to private instance..."
          ssh -o StrictHostKeyChecking=no ubuntu@${{ secrets.PRIVATE_INSTANCE_IP }} 'bash -s' <<'EOT'
          echo "ðŸš€ Starting deployment at $(date -u)"

          # Setup destination directory
          sudo rm -rf /opt/fullstack
          sudo mkdir -p /opt/fullstack
          sudo chown ubuntu:ubuntu /opt/fullstack
          cd /opt/fullstack

          # Extract archive
          cp /tmp/fullstack.tar.gz .
          tar xzf fullstack.tar.gz

          # Install backend dependencies and setup
          cd server
          npm install
          sudo systemctl daemon-reexec
          sudo systemctl daemon-reload
          sudo systemctl enable backend.service
          sudo systemctl start backend.service
          cd ..

          # Install frontend dependencies and build
          cd client
          npm install
          npm run build
          sudo systemctl daemon-reexec
          sudo systemctl daemon-reload
          sudo systemctl enable frontend.service
          sudo systemctl start frontend.service

          echo "âœ… Deployment completed at $(date -u)"
          EOT
          EOF
